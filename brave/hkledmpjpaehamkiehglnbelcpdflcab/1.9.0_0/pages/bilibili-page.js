(()=>{"use strict";var t,e={9612:(t,e,n)=>{function o(t,e){const n=t.lastIndexOf(".");let o=e;if(-1!==n){o=t.substring(n+1);const e=o.indexOf("?");-1!==e&&(o=o.substring(0,e))}return o}n.d(e,{UC:()=>s,YU:()=>o});const a=t=>`${t.language}:${t.label}:${t.url}`;function s({onJson:t,onRequest:e,waitForBasename:n}){setTimeout((()=>{const o={};let s="",i=!1;if(void 0!==t){const e=JSON.parse;JSON.parse=function(){const n=e.apply(this,arguments);let r=!1,c=!1;return t?.(n,(t=>{const e=window.location.pathname;void 0===o[e]&&(o[e]=[]);const n=a(t);void 0===o[e].find((t=>t.id===n))&&(o[e].push({id:n,...t}),r=!0)}),(t=>{s=t,c=!0})),i&&(r||c)&&document.dispatchEvent(new CustomEvent("asbplayer-synced-data",{detail:{error:"",basename:s,subtitles:o[window.location.pathname]}})),n}}document.addEventListener("asbplayer-get-synced-data",(async()=>{e?.((t=>{const e=window.location.pathname;void 0===o[e]&&(o[e]=[]);const n=a(t);void 0===o[e].find((t=>t.id===n))&&o[e].push({id:n,...t})}),(t=>{s=t,i||document.dispatchEvent(new CustomEvent("asbplayer-synced-data",{detail:{error:"",basename:s,subtitles:void 0}}))}));const t=()=>(!n||""!==s)&&window.location.pathname in o;t()||await function(t,e=1e4){return new Promise((async(n,o)=>{t()&&n(!0);const a=Date.now();let s=!1;for(;!s&&Date.now()<a+e;)await new Promise((e=>{setTimeout((()=>{s=t(),e()}),1e3)}));n(s)}))}(t),document.dispatchEvent(new CustomEvent("asbplayer-synced-data",{detail:{error:"",basename:s,subtitles:o[window.location.pathname]??[]}})),function(){for(const t of Object.keys(o))t!==window.location.pathname&&delete o[t]}(),i=!0}),!1)}),0)}}},n={};function o(t){var a=n[t];if(void 0!==a)return a.exports;var s=n[t]={exports:{}};return e[t](s,s.exports,o),s.exports}o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(0,(t=o(9612)).UC)({onJson:(e,n)=>{if(e?.data?.subtitles instanceof Array)for(const o of e.data.subtitles)if("string"==typeof o.lang&&"string"==typeof o.lang_key&&("object"==typeof o.srt&&"string"==typeof o.srt.url||"string"==typeof o.url)){const e=o.srt?.url??o.url,a=(0,t.YU)(e,"srt");n({label:o.lang,language:o.lang_key,url:e,extension:"json"===a?"bbjson":a})}},onRequest:(t,e)=>{e(document.title)},waitForBasename:!1})})();
//# sourceMappingURL=bilibili-page.js.map